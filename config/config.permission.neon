services:
    # Permissions
    PermissionObject:
        class: Wame\PermissionModule\Models\PermissionObject
        setup:
            # Default
            - addResource('Default')
            - addResourceAction('Default', 'default')
            - allow('client', 'Default', 'default')
            - addResourceAction('Default', 'show')
            - allow('client', 'Default', 'show')
            - addResourceAction('Default', 'create')
            - allow('moderator', 'Default', 'create')
            - addResourceAction('Default', 'edit')
            - allow('moderator', 'Default', 'edit')
            - addResourceAction('Default', 'delete')
            - allow('admin', 'Default', 'delete')

            # Role
            - addResource('Admin:Role')
            - addResourceAction('Admin:Role', 'default')
            - allow('admin', 'Admin:Role', 'default')
            - addResourceAction('Admin:Role', 'create')
            - allow('admin', 'Admin:Role', 'create')
            - addResourceAction('Admin:Role', 'edit')
            - allow('admin', 'Admin:Role', 'edit')
            - addResourceAction('Admin:Role', 'delete')
            - allow('admin', 'Admin:Role', 'delete')


    - Wame\PermissionModule\Models\PermissionLoader


    # Repositories
    PermissionRepository:
        class: Wame\PermissionModule\Repositories\PermissionRepository
        inject: yes

    RoleRepository:
        class: Wame\PermissionModule\Repositories\RoleRepository
        inject: yes


    # Form containers
    - Wame\PermissionModule\Forms\IRoleFormContainerFactory
    - Wame\PermissionModule\Forms\Containers\IRoleContainerFactory


    # Forms
    Admin.UserFormBuilder:
        setup:
            - add(@Wame\PermissionModule\Forms\Containers\IRoleContainerFactory(), 'RoleContainer', {priority: 80})


doctrine:
    metadata:
        Wame\PermissionModule\Entities: %appDir%/../vendor/wame/PermissionModule/entities
